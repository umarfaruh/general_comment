<style>
    .tiktok-comments {
        width: 500px;
        margin-left: 0;
        font-family: Arial, sans-serif;
    }

    .comment-input {
        width: 100%;
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 25px;
        font-size: 15px;
        outline: none;
        margin-bottom: 10px;
    }

    .send-btn {
        width: 100%;
        padding: 12px;
        background: #000;
        color: #fff;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 15px;
    }
    .send-btn:hover { opacity: 0.8; }

    .comment {
        margin-bottom: 15px;
    }

    .comment-bubble {
        background: #f1f1f1;
        padding: 12px 15px;
        border-radius: 15px;
        font-size: 16px;
        line-height: 1.4;
        word-break: break-word;
        animation: fadeIn 0.3s ease;
    }

    .reply-block {
        margin-left: 25px;
        margin-top: 10px;
    }

    .action-row {
        display: flex;
        gap: 15px;
        margin-top: 6px;
        font-size: 14px;
        color: #555;
    }

    .action-btn {
        cursor: pointer;
    }

    @keyframes fadeIn {
        from {opacity: 0; transform: translateY(5px);}
        to {opacity: 1; transform: translateY(0);}
    }
</style>

<div class="tiktok-comments">
    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>

    <textarea id="mainCommentInput" class="comment-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
    <button class="send-btn" onclick="sendComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

    <div id="commentsList"></div>
</div>

<script>
    let replyTo = null; 

    window.onload = function() {
        loadComments();
    };

    function sendComment() {
        let text = document.getElementById("mainCommentInput").value.trim();
        if (text === "") return;

        let comments = JSON.parse(localStorage.getItem("tiktokComments2") || "[]");

        if (!replyTo) {
            comments.push({
                id: Date.now(),
                text: text,
                likes: 0,
                time: new Date().toLocaleTimeString(),
                replies: []
            });
        } else {
            let parent = comments.find(c => c.id === replyTo);
            parent.replies.push({
                id: Date.now(),
                text: text,
                likes: 0,
                time: new Date().toLocaleTimeString()
            });
            replyTo = null;
        }

        localStorage.setItem("tiktokComments2", JSON.stringify(comments));
        document.getElementById("mainCommentInput").value = "";
        loadComments();
    }

    function likeComment(id, isReply=false, parentId=null) {
        let comments = JSON.parse(localStorage.getItem("tiktokComments2") || "[]");

        if (!isReply) {
            let c = comments.find(c => c.id === id);
            c.likes++;
        } else {
            let parent = comments.find(c => c.id === parentId);
            let r = parent.replies.find(r => r.id === id);
            r.likes++;
        }

        localStorage.setItem("tiktokComments2", JSON.stringify(comments));
        loadComments();
    }

    function deleteComment(id, isReply=false, parentId=null) {
        let comments = JSON.parse(localStorage.getItem("tiktokComments2") || "[]");

        if (!isReply) {
            comments = comments.filter(c => c.id !== id);
        } else {
            let parent = comments.find(c => c.id === parentId);
            parent.replies = parent.replies.filter(r => r.id !== id);
        }

        localStorage.setItem("tiktokComments2", JSON.stringify(comments));
        loadComments();
    }

    function replyToComment(id) {
        replyTo = id;
        document.getElementById("mainCommentInput").focus();
        document.getElementById("mainCommentInput").placeholder = "–û—Ç–≤–µ—Ç–∏—Ç—å...";
    }

    function loadComments() {
        let comments = JSON.parse(localStorage.getItem("tiktokComments2") || "[]");
        let html = "";

        comments.slice().reverse().forEach(c => {
            html += `
                <div class="comment">
                    <div class="comment-bubble">${c.text}</div>
                    <div class="action-row">
                        <span class="action-btn" onclick="likeComment(${c.id})">‚ù§Ô∏è ${c.likes}</span>
                        <span class="action-btn" onclick="replyToComment(${c.id})">–û—Ç–≤–µ—Ç–∏—Ç—å</span>
                        <span class="action-btn" onclick="deleteComment(${c.id})">üóë –£–¥–∞–ª–∏—Ç—å</span>
                        <span style="color:#777;">${c.time}</span>
                    </div>

                    ${c.replies.slice().reverse().map(r => `
                        <div class="reply-block">
                            <div class="comment-bubble">${r.text}</div>
                            <div class="action-row">
                                <span class="action-btn" onclick="likeComment(${r.id}, true, ${c.id})">‚ù§Ô∏è ${r.likes}</span>
                                <span class="action-btn" onclick="deleteComment(${r.id}, true, ${c.id})">üóë –£–¥–∞–ª–∏—Ç—å</span>
                                <span style="color:#777;">${r.time}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        });

        document.getElementById("commentsList").innerHTML = html;
        document.getElementById("mainCommentInput").placeholder = "–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...";
    }
</script>









<style>
.private-msg-box, .admin-box {
    max-width: 500px;
    font-family: Arial, sans-serif;
    margin-bottom: 20px;
}
.input-field, .reply-text {
    width: 100%;
    padding: 12px;
    margin-bottom: 10px;
    border-radius: 12px;
    border: 1px solid #ccc;
}
.send-btn, .send-reply-btn {
    width: 100%;
    padding: 12px;
    border: none;
    background: black;
    color: white;
    border-radius: 12px;
    cursor: pointer;
}
.send-btn:hover, .send-reply-btn:hover { opacity: 0.8; }

.msg, .client-msg, .admin-msg {
    background: #f1f1f1;
    padding: 10px;
    margin-bottom: 8px;
    border-radius: 10px;
}
.admin-msg {
    background: #d1e7dd;
}
</style>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ -->
<div class="private-msg-box">
    <h3>–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</h3>
    <textarea id="clientMsg" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
    <button class="send-btn" onclick="sendClientMsg()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <h4>–í–∞—à –¥–∏–∞–ª–æ–≥ —Å –∞–¥–º–∏–Ω–æ–º:</h4>
    <div id="clientChat"></div>
</div>

<!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
<div class="admin-box">
    <h3>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
    <div id="adminList"></div>
</div>

<script>
// –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ–æ–±—â–µ–Ω–∏–π
// messages = [{id, text, time, fromAdmin, replied}]
let messages = JSON.parse(localStorage.getItem("siteMessages") || "[]");

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
function sendClientMsg() {
    let text = document.getElementById("clientMsg").value.trim();
    if(text === "") return;

    messages.push({
        id: Date.now(),
        text: text,
        time: new Date().toLocaleString(),
        fromAdmin: false
    });

    localStorage.setItem("siteMessages", JSON.stringify(messages));
    document.getElementById("clientMsg").value = "";
    loadClientChat();
    loadAdminPanel();
}

// –ü–æ–∫–∞–∑ —á–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É
function loadClientChat() {
    let html = "";
    messages.forEach(m => {
        if(m.fromAdmin){
            html += `<div class="admin-msg"><strong>–ê–¥–º–∏–Ω:</strong> ${m.text}<br><small>${m.time}</small></div>`;
        } else {
            html += `<div class="client-msg"><strong>–í—ã:</strong> ${m.text}<br><small>${m.time}</small></div>`;
        }
    });
    document.getElementById("clientChat").innerHTML = html;
}

// –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function loadAdminPanel() {
    let html = "";
    messages.forEach((m,i) => {
        if(!m.fromAdmin){
            html += `
                <div class="msg">
                    <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${m.text}</p>
                    <small>${m.time}</small>
                    <input type="text" class="reply-text" id="reply${i}" placeholder="–û—Ç–≤–µ—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É...">
                    <button class="send-reply-btn" onclick="sendAdminReply(${i})">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                </div>`;
        }
    });
    document.getElementById("adminList").innerHTML = html;
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –∞–¥–º–∏–Ω–∞
function sendAdminReply(i){
    let reply = document.getElementById(`reply${i}`).value.trim();
    if(reply === "") return;

    messages.push({
        id: Date.now(),
        text: reply,
        time: new Date().toLocaleString(),
        fromAdmin: true
    });

    localStorage.setItem("siteMessages", JSON.stringify(messages));
    document.getElementById(`reply${i}`).value = "";
    loadAdminPanel();
    loadClientChat();
}

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
loadClientChat();
loadAdminPanel();
</script>
